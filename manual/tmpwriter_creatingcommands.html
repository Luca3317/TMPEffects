<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Creating commands | TMPEffects documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Creating commands | TMPEffects documentation ">
    <meta name="generator" content="docfx 2.59.4.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/night-owl.min.css">
    <link rel="stylesheet" href="../styles/colors.css">
    <link rel="stylesheet" href="../styles/discord.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    
  </head>

  <body>
        <div class="top-navbar">

            <a class="burger-icon" onclick="toggleMenu()">
                <svg name="Hamburger" style="vertical-align: middle;" width="24" height="24" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M20 6H4V9H20V6ZM4 10.999H20V13.999H4V10.999ZM4 15.999H20V18.999H4V15.999Z"></path></svg>
            </a>

            
            <a class="brand" href="../index.html">
              <img src="../logo.svg" alt="" class="logomark">
              <span class="brand-title"></span>
            </a>
        </div>

        <div class="body-content">

            <div id="blackout" class="blackout" onclick="toggleMenu()"></div>

            <nav id="sidebar" role="navigation">

                <div class="sidebar">
                    
                    
                    <div>
                      <div class="mobile-hide">
                        
                        <a class="brand" href="../index.html">
                          <img src="../logo.svg" alt="" class="logomark">
                          <span class="brand-title"></span>
                        </a>  </div>
                    
                          <div class="sidesearch">
                              <form id="search" role="search" class="search">
                                  <svg width="20" height="20" class="search-icon" viewbox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg>
                                  <input type="text" id="search-query" placeholder="Search" autocomplete="off">
                              </form>
                          </div>
                    
                      <div id="navbar">
                      </div>
                    
                    </div>
                    

                    <div class="sidebar-item-separator"></div>

                        
                        <div id="sidetoggle">
                          <div id="sidetoc"></div>
                        </div>

                </div>

                <div class="footer">
                  TMPEffects documentation
                  
                </div>
            </nav>

            <main class="main-panel">

                    
                    <div id="search-results" class="main-panel-content" style="display: none;">
                      <h1 class="search-list">Search Results for <span></span></h1>
                      <div class="sr-items">
                        <p><svg class="index-loading" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></p>
                      </div>
                      <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
                    </div>
                <div role="main" class="main-panel-content hide-when-search">

                        
                        <div class="subnav navbar navbar-default">
                          <div class="container hide-when-search" id="breadcrumb">
                            <ul class="breadcrumb">
                              <li></li>
                            </ul>
                          </div>
                        </div>

                    <article class="content wrap" id="_content" data-uid="">
<h1 id="creating-commands">Creating commands</h1>

<p>This section walks you through creating your own commands.
First, create a new C# script in the Unity editor.</p>
<h3 id="creating-the-class">Creating the class</h3>
<p>Add the following using statement at the top of your class: <mark style="color: lightgray; background-color: #191a18">using TMPEffects.TMPCommands;</mark>.<br>Then, make the created class derive from <mark style="color: lightgray; background-color: #191a18">TMPCommand</mark>.
In order to be able to create the command object in the Unity editor and add it to your database, make sure to decorate the class with the <a href="https://docs.unity3d.com/ScriptReference/CreateAssetMenuAttribute.html">CreateAssetMenu</a> attribute.</p>
<h3 id="members">Members</h3>
<p>You will have errors due to <mark style="color: lightgray; background-color: #191a18">TMPCommand&#39;s</mark> abstract members not being implemented.
Auto-implement them using your IDE, or add them manually.
When you are done, your class should look something like this:</p>
<pre><code class="lang-csharp">using UnityEngine;
using TMPEffects.TMPCommands;

[CreateAssetMenu(fileName=&quot;new YourFirstCommand&quot;, menuName=&quot;Your/Path/YourFirstCommand&quot;)]
public class YourFirstCommand : TMPCommand
{
    public override TagType TagType =&gt; throw new System.NotImplementedException();

    public override bool ExecuteInstantly =&gt; throw new System.NotImplementedException();

    public override bool ExecuteOnSkip =&gt; throw new System.NotImplementedException();

    public override void ExecuteCommand(TMPCommandArgs args)
    {
        throw new System.NotImplementedException();
    }

    public override bool ValidateParameters(IDictionary&lt;string, string&gt; parameters)
    {
        throw new System.NotImplementedException();
    }
}
</code></pre><p>Let&#39;s go over each member individually.</p>
<h3 id="properties">Properties</h3>
<p><strong><mark style="color: lightgray; background-color: #191a18">TagType</mark></strong>: Defines whether the tags for this command should operate on an index, a text block, or either option. For example, the built-in <mark style="color: lightgray; background-color: #191a18">wait</mark>
command operates on an index, and the built-in command <mark style="color: lightgray; background-color: #191a18">show</mark> operates on a text block (see <a href="tmpwriter_builtincommands.html">Built-in commands</a>).</p>
<p><strong><mark style="color: lightgray; background-color: #191a18">ExecuteInstantly</mark></strong>: Commands where this property is true are executed the moment the TMPWriter begins the writing process, instead of when their opening tag index is reached. From the built-in tags, only <mark style="color: lightgray; background-color: #191a18">show</mark> is executed instantly.</p>
<p><strong><mark style="color: lightgray; background-color: #191a18">ExecuteOnSkip</mark></strong>: Commands where this property is true are executed even when their index is skipped over by the writer (i.e., when TMPWriter.SkipWriter() is called). This should be true for commands
that need to ensure they are being called even if skipped over, for example a command that starts a quest or adds an item to the player&#39;s inventory.</p>
<h3 id="optional-properties">Optional properties</h3>
<p>There are a few optional properties. If you don&#39;t override them, they are set to false by default. In both cases, this is to protect you from yourself <span class="emoji" shortcode="wink">😉</span><br>Only set these to true if you are sure it is safe for your case!</p>
<p><strong><mark style="color: lightgray; background-color: #191a18">ExecuteRepeatable</mark></strong>: Commands where this property is true may be executed multiple times, specifically if the writer is reset / restarted at any point (i.e., when TMPWriter.ResetWriter() is called).
This should be false for commands that need to ensure they are only ever raised once, for example a command that starts a quest or adds an item to the player&#39;s inventory.</p>
<p><strong><mark style="color: lightgray; background-color: #191a18">ExecuteInPreview</mark></strong>: Commands where this property is true are executed in the editor preview. <span class="emoji" shortcode="warning">⚠️</span> Note that you must wrap this property in a <mark style="color: lightgray; background-color: #191a18">#if UNITY_EDITOR</mark>
preprocessor directive if you want to override it; otherwise your builds will fail.</p>
<h3 id="methods">Methods</h3>
<p><strong><mark style="color: lightgray; background-color: #191a18">ValidateParameters(IDictionary&lt;string, string&gt; parameters)</mark></strong>: This method is called during tag processing. It allows you to specify whether a given tag for this command has valid parameters. <a href="parameterutility.html">ParameterUtility</a> will come in handy here.
Return true if the parameters are valid, return false if not. If false, the tag will not be processed.</p>
<p><strong><mark style="color: lightgray; background-color: #191a18">ExecuteCommand(TMPCommandArgs args)</mark></strong>: The meat of your command. This executes the actual command you are implementing.</p>
<h3 id="tmpcommandargs">TMPCommandArgs</h3>
<p>The sole argument for the <mark style="color: lightgray; background-color: #191a18">ExecuteCommand</mark> method. It&#39;s kept relatively simple:
it provides access to the actual <mark style="color: lightgray; background-color: #191a18">EffectTag</mark>, through which you may get the tag&#39;s parameters, the <mark style="color: lightgray; background-color: #191a18">EffectTagIndices</mark>, and the executing TMPWriter.</p>
<h3 id="full-example">Full example</h3>
<p>As complete example, the class below is the implementation of the built-in <mark style="color: lightgray; background-color: #191a18">delay</mark> command.</p>
<pre><code class="lang-csharp">using System.Collections.Generic;
using UnityEngine;

namespace TMPEffects.TMPCommands.Commands
{
    [CreateAssetMenu(fileName = &quot;new DelayCommand&quot;, menuName = &quot;TMPEffects/Commands/Delay&quot;)]
    public class DelayCommand : TMPCommand
    {
        public override TagType TagType =&gt; TagType.Index;
        public override bool ExecuteInstantly =&gt; false;
        public override bool ExecuteOnSkip =&gt; true;
        public override bool ExecuteRepeatable =&gt; true;

#if UNITY_EDITOR
        public override bool ExecuteInPreview =&gt; true;
#endif

        public override void ExecuteCommand(TMPCommandArgs args)
        {
            if (ParameterUtility.TryGetFloatParameter(out float delay, args.tag.Parameters, &quot;&quot;))
            {
                args.writer.SetDelay(delay);
                return;
            }

            // Since validate parameters ensures the parameter is present and float,
            // this state should be impossible to reach
            throw new System.InvalidOperationException();
        }

        public override bool ValidateParameters(IDictionary&lt;string, string&gt; parameters)
        {
            if (parameters == null) return false;
            if (!parameters.ContainsKey(&quot;&quot;))
                return false;

            return ParameterUtility.HasFloatParameter(parameters, &quot;&quot;);
        }
    }
}
</code></pre><h3 id="adding-the-command-to-a-database">Adding the command to a database</h3>
<p>To actually use the command in your text, you will have to follow these steps:</p>
<ol>
<li>Create a command object: Right click in your project view and create it (it will be in the path you specified in the <a href="https://docs.unity3d.com/ScriptReference/CreateAssetMenuAttribute.html">CreateAssetMenu</a> attribute).</li>
<li>Add that object to the database you want to use and give it a name</li>
<li>Use that database in the TMPWriter component</li>
</ol>
<p>Done! You can now use your custom command like any of the built-in ones.</p>
<h3 id="creating-scene-commands">Creating scene commands</h3>
<p>See <a href="tmpwriter_scenecommands.html">Scene commands</a> on how to add scene commands.</p>
</article>
              
                </div>
            </main>
        </div>

        
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
<script type="text/javascript" src="../styles/jquery.twbsPagination.js"></script>
<script type="text/javascript" src="../styles/url.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
<script type="text/javascript" src="../styles/docfx.js"></script>
<script type="text/javascript" src="../styles/main.js"></script>

    </body>

</html>

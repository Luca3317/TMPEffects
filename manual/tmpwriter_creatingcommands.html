<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Creating commands | TMPEffects documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Creating commands | TMPEffects documentation ">
    <meta name="generator" content="docfx 2.59.4.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="creating-commands">Creating commands</h1>

<p>This section walks you through creating your own commands.
First, create a new C# script in the Unity editor.</p>
<h3 id="creating-the-class">Creating the class</h3>
<p>Add the following using statement at the top of your class: <mark style="color: lightgray; background-color: #191a18">using TMPEffects.TMPCommands;</mark>.<br>Then, make the created class derive from <mark style="color: lightgray; background-color: #191a18">TMPCommand</mark>.
In order to be able to create the command object in the Unity editor and add it to your database, make sure to decorate the class with the <a href="https://docs.unity3d.com/ScriptReference/CreateAssetMenuAttribute.html">CreateAssetMenu</a> attribute.</p>
<h3 id="members">Members</h3>
<p>You will have errors due to <mark style="color: lightgray; background-color: #191a18">TMPCommand&#39;s</mark> abstract members not being implemented.
Auto-implement them using your IDE, or add them manually.
When you are done, your class should look something like this:</p>
<pre><code class="lang-csharp">using UnityEngine;
using TMPEffects.TMPCommands;

[CreateAssetMenu(fileName=&quot;new YourFirstCommand&quot;, menuName=&quot;Your/Path/YourFirstCommand&quot;)]
public class YourFirstCommand : TMPCommand
{
    public override TagType TagType =&gt; throw new System.NotImplementedException();

    public override bool ExecuteInstantly =&gt; throw new System.NotImplementedException();

    public override bool ExecuteOnSkip =&gt; throw new System.NotImplementedException();

    public override void ExecuteCommand(TMPCommandArgs args)
    {
        throw new System.NotImplementedException();
    }

    public override bool ValidateParameters(IDictionary&lt;string, string&gt; parameters)
    {
        throw new System.NotImplementedException();
    }
}
</code></pre><p>Let&#39;s go over each member individually.</p>
<h3 id="properties">Properties</h3>
<p><strong><mark style="color: lightgray; background-color: #191a18">TagType</mark></strong>: Defines whether the tags for this command should operate on an index, a text block, or either option. For example, the built-in <mark style="color: lightgray; background-color: #191a18">wait</mark>
command operates on an index, and the built-in command <mark style="color: lightgray; background-color: #191a18">show</mark> operates on a text block (see <a href="tmpwriter_builtincommands.html">Built-in commands</a>).</p>
<p><strong><mark style="color: lightgray; background-color: #191a18">ExecuteInstantly</mark></strong>: Commands where this property is true are executed the moment the TMPWriter begins the writing process, instead of when their opening tag index is reached. From the built-in tags, only <mark style="color: lightgray; background-color: #191a18">show</mark> is executed instantly.</p>
<p><strong><mark style="color: lightgray; background-color: #191a18">ExecuteOnSkip</mark></strong>: Commands where this property is true are executed even when their index is skipped over by the writer (i.e., when TMPWriter.SkipWriter() is called). This should be true for commands
that need to ensure they are being called even if skipped over, for example a command that starts a quest or adds an item to the player&#39;s inventory.</p>
<h3 id="optional-properties">Optional properties</h3>
<p>There are a few optional properties. If you don&#39;t override them, they are set to false by default. In both cases, this is to protect you from yourself <span class="emoji" shortcode="wink">😉</span><br>Only set these to true if you are sure it is safe for your case!</p>
<p><strong><mark style="color: lightgray; background-color: #191a18">ExecuteRepeatable</mark></strong>: Commands where this property is true may be executed multiple times, specifically if the writer is reset / restarted at any point (i.e., when TMPWriter.ResetWriter() is called).
This should be false for commands that need to ensure they are only ever raised once, for example a command that starts a quest or adds an item to the player&#39;s inventory.</p>
<p><strong><mark style="color: lightgray; background-color: #191a18">ExecuteInPreview</mark></strong>: Commands where this property is true are executed in the editor preview. <span class="emoji" shortcode="warning">⚠️</span> Note that you must wrap this property in a <mark style="color: lightgray; background-color: #191a18">#if UNITY_EDITOR</mark>
preprocessor directive if you want to override it; otherwise your builds will fail.</p>
<h3 id="methods">Methods</h3>
<p><strong><mark style="color: lightgray; background-color: #191a18">ValidateParameters(IDictionary&lt;string, string&gt; parameters)</mark></strong>: This method is called during tag processing. It allows you to specify whether a given tag for this command has valid parameters. <a href="parameterutility.html">ParameterUtility</a> will come in handy here.
Return true if the parameters are valid, return false if not. If false, the tag will not be processed.</p>
<p><strong><mark style="color: lightgray; background-color: #191a18">ExecuteCommand(TMPCommandArgs args)</mark></strong>: The meat of your command. This executes the actual command you are implementing.</p>
<h3 id="tmpcommandargs">TMPCommandArgs</h3>
<p>The sole argument for the <mark style="color: lightgray; background-color: #191a18">ExecuteCommand</mark> method. It&#39;s kept relatively simple:
it provides access to the actual <mark style="color: lightgray; background-color: #191a18">EffectTag</mark>, through which you may get the tag&#39;s parameters, the <mark style="color: lightgray; background-color: #191a18">EffectTagIndices</mark>, and the executing TMPWriter.</p>
<h3 id="full-example">Full example</h3>
<p>As complete example, the class below is the implementation of the built-in <mark style="color: lightgray; background-color: #191a18">delay</mark> command.</p>
<pre><code class="lang-csharp">using System.Collections.Generic;
using UnityEngine;

namespace TMPEffects.TMPCommands.Commands
{
    [CreateAssetMenu(fileName = &quot;new DelayCommand&quot;, menuName = &quot;TMPEffects/Commands/Delay&quot;)]
    public class DelayCommand : TMPCommand
    {
        public override TagType TagType =&gt; TagType.Index;
        public override bool ExecuteInstantly =&gt; false;
        public override bool ExecuteOnSkip =&gt; true;
        public override bool ExecuteRepeatable =&gt; true;

#if UNITY_EDITOR
        public override bool ExecuteInPreview =&gt; true;
#endif

        public override void ExecuteCommand(TMPCommandArgs args)
        {
            if (ParameterUtility.TryGetFloatParameter(out float delay, args.tag.Parameters, &quot;&quot;))
            {
                args.writer.SetDelay(delay);
                return;
            }

            // Since validate parameters ensures the parameter is present and float,
            // this state should be impossible to reach
            throw new System.InvalidOperationException();
        }

        public override bool ValidateParameters(IDictionary&lt;string, string&gt; parameters)
        {
            if (parameters == null) return false;
            if (!parameters.ContainsKey(&quot;&quot;))
                return false;

            return ParameterUtility.HasFloatParameter(parameters, &quot;&quot;);
        }
    }
}
</code></pre><h3 id="adding-the-command-to-a-database">Adding the command to a database</h3>
<p>To actually use the command in your text, you will have to follow these steps:</p>
<ol>
<li>Create a command object: Right click in your project view and create it (it will be in the path you specified in the <a href="https://docs.unity3d.com/ScriptReference/CreateAssetMenuAttribute.html">CreateAssetMenu</a> attribute).</li>
<li>Add that object to the database you want to use and give it a name</li>
<li>Use that database in the TMPWriter component</li>
</ol>
<p>Done! You can now use your custom command like any of the built-in ones.</p>
<h3 id="creating-scene-commands">Creating scene commands</h3>
<p>See <a href="tmpwriter_scenecommands.html">Scene commands</a> on how to add scene commands.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/Luca3317/TMPEffects/blob/docs-rework/Documentation~/manual/tmpwriter_creatingcommands.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <div class="toggle-mode">
                <div class="icon">
                  <i aria-hidden="true">☀</i>
                </div>
                <label class="switch">
                  <input type="checkbox" id="switch-style">
                  <span class="slider round"></span>
                </label>
                <div class="icon">
                  <i aria-hidden="true">☾</i>
                </div>
              </div>
          
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <h5>In This Article</h5>
              <div></div>
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <div class="pull-left">
              TMPEffects documentation
              
            </div>
            <div class="toggle-mode pull-right visible-sm visible-xs">
              <div class="icon">
                <i aria-hidden="true">☀</i>
              </div>
              <label class="switch">
                <input type="checkbox" id="switch-style-m">
                <span class="slider round"></span>
              </label>
              <div class="icon">
                <i aria-hidden="true">☾</i>
              </div>
            </div>
          </div>
        </div>
        <script type="text/javascript" src="../styles/toggle-theme.js"></script>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
